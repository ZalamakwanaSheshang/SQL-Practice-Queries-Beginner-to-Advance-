USE RISE_TASKS_1

-- create tables
/*
1. Employee
- EID
- ENAME
- SALARY
- DEPARTMENT_ID
- MANGER_ID

2. MANGER
- MID
- MNAME

3. DEPARTMENT
- DEPARTMENT_ID
- DEPARTMENT_NAME

4. PROJECT
- PID
- PNAME
- EID
*/

CREATE TABLE EMPLOYEE(
EID VARCHAR(255),
ENAME VARCHAR(255),
SALARY MONEY,
DEPARTMENT_ID VARCHAR(255),
MANGER_ID VARCHAR(255)
)

CREATE TABLE MANGER(
MID VARCHAR(255),
MNAME VARCHAR(255)
)

CREATE TABLE DEPARTMENT(
DEP_ID VARCHAR(255),
DEP_NAME VARCHAR(255)
)

CREATE TABLE PROJECT(
PID VARCHAR(255),
PNAME VARCHAR(255),
EID VARCHAR(255)
)

SELECT * FROM PROJECT
SELECT * FROM EMPLOYEE
SELECT * FROM DEPARTMENT
SELECT * FROM MANGER

-- INSERT VALUES IN THIS TABLES
INSERT INTO MANGER VALUES
('M1','KETAN RATHOD'),
('M2','VIDHI JAIN'),
('M3','JAIMIN RABARI')

INSERT INTO DEPARTMENT VALUES
('D01','FULLSTACK'),
('D02','DATA SCIENCE'),
('D03','QUALITY ASSURANCE')
/*
SELECT*FROM DEPARTMENT

DELETE FROM DEPARTMENT
WHERE DEP_ID = 'DO3'
*/

INSERT INTO EMPLOYEE VALUES
('E001','SHESHANG ZALAMAKWANA',50000,'D01','M1'),
('E002','JIMIT SHAH',70000,'D02','M2'),
('E003','VRAJ SHAH',40000,'D03','M3'),
('E004','DIGVIJAYSINH PARMAR',45000,'D01','M3'),
('E004','RUSHABH',55000,'D03','M1')

UPDATE EMPLOYEE
SET EID = 'E005'
WHERE ENAME = 'RUSHABH'

UPDATE EMPLOYEE
SET ENAME = 'RUSHABH KAUSALYA'
WHERE EID = 'E005'

INSERT INTO PROJECT VALUES
('P01','AI_ASSISTANT','E002'),
('P02','ONLINE_FOOD_BOOKING','E001'),
('P03','STO_PO1_&_P03','E005')

UPDATE PROJECT
SET PNAME = 'STO_PO1_&_P02'
WHERE PID = 'P03'

-- 1. Fetch only employee & their Department Name
SELECT E.EID, E.ENAME, D.DEP_NAME FROM EMPLOYEE E
JOIN DEPARTMENT D
ON E.DEPARTMENT_ID = D.DEP_ID

-- 2. Fetch all employee & their Department Name
INSERT INTO EMPLOYEE(EID,ENAME,SALARY,MANGER_ID) VALUES
('E006','HARDIK PARMAR','35000','M2')

SELECT E.EID, E.ENAME, D.DEP_NAME FROM EMPLOYEE E
LEFT JOIN DEPARTMENT D
ON E.DEPARTMENT_ID = D.DEP_ID

-- 3.  Fetch all employees working on Project Cloud
INSERT INTO PROJECT VALUES
('P04','CLOUD','E004')

SELECT E.EID,E.ENAME,P.PNAME FROM EMPLOYEE E
JOIN PROJECT P
ON E.EID = P.EID
WHERE P.PNAME = 'CLOUD'

-- 4. Fetch employees & their Manager name
SELECT E.EID, E.ENAME, M.MNAME FROM EMPLOYEE E
JOIN MANGER M
ON E.MANGER_ID = M.MID

-- 5. Fetch employee name, manager name, department name, 
--	  & project they are working on
SELECT E.ENAME,M.MNAME,D.DEP_NAME,P.PNAME FROM EMPLOYEE E
JOIN MANGER M
ON E.MANGER_ID = M.MID
JOIN DEPARTMENT D
ON E.DEPARTMENT_ID = D.DEP_ID
JOIN PROJECT P
ON E.EID = P.EID

SELECT E.ENAME,M.MNAME,D.DEP_NAME,P.PNAME FROM EMPLOYEE E
LEFT JOIN MANGER M
ON E.MANGER_ID = M.MID
LEFT JOIN DEPARTMENT D
ON E.DEPARTMENT_ID = D.DEP_ID
LEFT JOIN PROJECT P
ON E.EID = P.EID

-- 6. Fetch Employees not working on any Project
SELECT E.EID,E.ENAME,E.SALARY,P.PNAME FROM EMPLOYEE E
LEFT JOIN PROJECT P
ON E.EID = P.EID
WHERE P.PNAME IS NULL

SELECT * FROM EMPLOYEE